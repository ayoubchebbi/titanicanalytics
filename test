  // Convert date to Date object if provided as string
  let dateToCompare = date instanceof Date ? new Date(date) : new Date(date);
  
  // Reset time portion to ensure we're only comparing dates
  dateToCompare.setHours(0, 0, 0, 0);
  
  // Get today's date (without hours, minutes, seconds)
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  // Calculate difference in milliseconds
  const differenceMs = dateToCompare.getTime() - today.getTime();
  
  // Convert to days then weeks (rounded to nearest integer)
  const millisecondsPerDay = 24 * 60 * 60 * 1000;
  const differenceDays = differenceMs / millisecondsPerDay;
  const differenceWeeks = Math.floor(differenceDays / 7);
  
  // If it's today, return 1
  if (differenceMs === 0) return 1;
  
  // If it's in the past, subtract 1 from the negative result
  if (differenceMs < 0) {
    return differenceWeeks - 1;
  }
  
  // If it's in the future, return the week number (starting with 1 for current week)
  return differenceWeeks + 1;
