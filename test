SELECT Id, Status, TEKCO_DeliveryPlanID__c, EarliestStartTime
FROM ServiceAppointment
WHERE ServiceTerritoryId = :stId
  AND Status NOT IN ('005', '007')
  AND TEKCO_DeliveryPlanID__c != null
  AND EarliestStartTime <= :startDate
  AND EarliestStartTime >= :endDate
LIMIT 2000
