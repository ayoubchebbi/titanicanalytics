

**Solution tested and working.**

To replicate the test on the same record:
1. Change the status from "woli" to "new"
2. Clear the actual quantity field that was previously filled
3. Delete the asset that was created during the previous test

**Test link provided below:**

---

This version is more structured and easier to follow, with numbered steps for the testing procedure.


SELECT Id, ApexClass.Name, JobType, Status, CreatedDate, CompletedDate, NumberOfErrors 
FROM AsyncApexJob 
WHERE ApexClass.Name = 'FSCO_AutoBindingSchedule'
AND DAY_ONLY(CreatedDate) = 2024-05-22
ORDER BY CreatedDate DESC<template if:true={hasError}>
    <div class="slds-notify slds-notify_alert slds-alert_error" role="alert">
        <span class="slds-assistive-text">Error</span>
        <span class="slds-icon_container slds-icon-utility-error slds-m-right_small" title="Error">
            <lightning-icon icon-name="utility:error" alternative-text="Error" variant="error" size="small"></lightning-icon>
        </span>
        <h2>
            <strong>Error</strong>: Merci de contacter l’administrateur pour traiter l’erreur.
        </h2>
    </div>
</template>


SELECT Id, Status, TEKCO_DeliveryPlanID__c, EarliestStartTime
FROM ServiceAppointment
WHERE ServiceTerritoryId = :stId
  AND Status NOT IN ('005', '007')
  AND TEKCO_DeliveryPlanID__c != null
  AND EarliestStartTime <= :startDate
  AND EarliestStartTime >= :endDate
LIMIT 2000
