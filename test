// Texte à chiffrer
String plainText = 'Hello World!';

// Clé secrète (32 octets pour AES-256)
Blob key = Crypto.generateAesKey(256);

// Initialisation du vecteur (IV)
Blob iv = Crypto.generateRandomBytes(16);

// Conversion du texte en blob
Blob input = Blob.valueOf(plainText);

// Chiffrement avec IV géré manuellement
Blob encrypted = Crypto.encrypt('AES256', key, iv, input);

// Déchiffrement
Blob decrypted = Crypto.decrypt('AES256', key, iv, encrypted);

// Résultat en texte
String decryptedText = decrypted.toString();

// Logs
System.debug('Original Text: ' + plainText);
System.debug('Encrypted (Base64): ' + EncodingUtil.base64Encode(encrypted));
System.debug('Decrypted Text: ' + decryptedText);
