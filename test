<apex:page controller="TerritoryController">
    <apex:includeLightning />

    <script>
        function refreshViewVehicleStock(TerritoryId) {
            if (!TerritoryId) return;

            var divViewStock = document.getElementById('lightningvf');
            divViewStock.innerHTML = "Loading..."; // Afficher un message temporaire

            $Lightning.use("c:FSCIT_includeViewVehicleStockonVFPage", function() {
                $Lightning.createComponent("c:prdcoViewVehiclesStock",
                    { "recordId" : TerritoryId },
                    "lightningvf",
                    function(cmp) {
                        console.log("Component loaded for TerritoryId:", TerritoryId);
                    }
                );
            });
        }
    </script>

    <apex:form>
        <apex:pageBlock title="Select a Territory">
            <apex:selectList id="territorySelector" size="1" onchange="refreshViewVehicleStock(this.value)">
                <apex:selectOptions value="{!territories}"/>
            </apex:selectList>
        </apex:pageBlock>
    </apex:form>

    <div id="lightningvf"></div>

</apex:page>
