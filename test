// ========== METTRE VOTRE ID TERRITOIRE ICI ==========
Id territoryId = '0Hh...'; // Remplacez par votre ID rÃ©el
// ====================================================

// RÃ©cupÃ©rer les Operating Hours du territoire
ServiceTerritory territory = [
    SELECT Id, OperatingHoursId 
    FROM ServiceTerritory 
    WHERE Id = :territoryId 
    LIMIT 1
];

System.debug('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
System.debug('â•‘  TEST RESOURCE AVAILABILITY - TERRITORY: ' + territory.Id);
System.debug('â•‘  Operating Hours: ' + territory.OperatingHoursId);
System.debug('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// RÃ©cupÃ©rer tous les TimeSlots
List<TimeSlot> allTimeSlots = [
    SELECT Id, OperatingHoursId, StartTime, EndTime, Type, DayOfWeek 
    FROM TimeSlot 
    WHERE OperatingHoursId = :territory.OperatingHoursId
    ORDER BY DayOfWeek, StartTime
];

System.debug('Total TimeSlots trouvÃ©s: ' + allTimeSlots.size() + '\n');

// Grouper par jour
Map<String, List<TimeSlot>> slotsByDay = new Map<String, List<TimeSlot>>();

for(TimeSlot ts : allTimeSlots) {
    if(!slotsByDay.containsKey(ts.DayOfWeek)) {
        slotsByDay.put(ts.DayOfWeek, new List<TimeSlot>());
    }
    slotsByDay.get(ts.DayOfWeek).add(ts);
}

// Tester chaque jour
for(String dayName : slotsByDay.keySet()) {
    List<TimeSlot> slotsForDay = slotsByDay.get(dayName);
    
    System.debug('â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”');
    System.debug('â”‚ ğŸ“… ' + dayName.toUpperCase());
    System.debug('â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤');
    System.debug('â”‚ Nombre de slots: ' + slotsForDay.size());
    System.debug('â”‚');
    
    // Afficher tous les slots
    for(Integer i = 0; i < slotsForDay.size(); i++) {
        TimeSlot slot = slotsForDay[i];
        System.debug('â”‚ Slot #' + (i+1) + ': ' + slot.StartTime + ' â†’ ' + slot.EndTime);
    }
    
    System.debug('â”‚');
    System.debug('â”‚ â”€â”€â”€â”€â”€â”€â”€â”€ CALCUL AVAILABILITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
    System.debug('â”‚');
    
    // CrÃ©er ResourceAvailability (utilise votre classe interne)
    FSCO_ReturnToBranchExecutionHelper.ResourceAvailability availability = 
        new FSCO_ReturnToBranchExecutionHelper.ResourceAvailability(slotsForDay);
    
    // Afficher les rÃ©sultats
    String morningDisplay = availability.morningStartTime != null 
        ? String.valueOf(availability.morningStartTime) 
        : 'âŒ AUCUN';
        
    String afternoonDisplay = availability.afternoonStartTime != null 
        ? String.valueOf(availability.afternoonStartTime) 
        : 'âŒ AUCUN';
    
    System.debug('â”‚ ğŸŒ… Commence MATIN:       ' + morningDisplay);
    System.debug('â”‚ ğŸŒ† Commence APRÃˆS-MIDI:  ' + afternoonDisplay);
    System.debug('â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n');
}

System.debug('âœ… Test terminÃ© avec succÃ¨s!');
